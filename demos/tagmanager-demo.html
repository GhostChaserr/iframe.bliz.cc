<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tag Manager / Script Injection Demo</title>
    <style>
        /* --- Mock Website Styles (To simulate a real environment) --- */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #ffffff;
            color: #333;
        }

        header {
            background-color: #2c3e50;
            color: white;
            padding: 1rem 5%;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .hero {
            background-color: #ecf0f1;
            padding: 4rem 5%;
            text-align: center;
            border-bottom: 1px solid #bdc3c7;
        }

        /* --- Demo Control Panel Styles --- */
        .demo-controls {
            max-width: 800px;
            margin: -30px auto 50px; /* Overlap hero slightly */
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            position: relative;
            z-index: 10; /* Lower than the popup (9999) */
            border: 2px solid #3498db;
        }

        .btn-reset {
            background-color: #e74c3c;
            color: white;
            border: none;
            padding: 10px 20px;
            font-size: 16px;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 10px;
        }
        .btn-reset:hover { background-color: #c0392b; }

        code {
            background: #f4f4f4;
            padding: 2px 5px;
            border-radius: 3px;
            font-family: monospace;
            color: #c7254e;
        }
    </style>
</head>
<body>

    <!-- 1. Mock Website Background -->
    <header>
        <div style="font-weight:bold; font-size:1.5rem;">FashionHub</div>
        <nav>
            <span style="margin-left:20px; opacity:0.7;">Home</span>
            <span style="margin-left:20px; opacity:0.7;">Shop</span>
            <span style="margin-left:20px; opacity:0.7;">About</span>
        </nav>
    </header>

    <div class="hero">
        <h1>Summer Collection 2025</h1>
        <p>This is a standard landing page. The game script is injected automatically.</p>
    </div>

    <!-- 2. Demo Controls (For testing the cookie logic) -->
    <div class="demo-controls">
        <h2>Tag Manager Simulation</h2>
        <p>
            The script below has been injected into this page. It checks if you have seen the widget before.
        </p>
        <ul>
            <li>If you see the popup: The script ran successfully.</li>
            <li>If you <strong>don't</strong> see it: The script found the <code>widgetShown</code> cookie.</li>
        </ul>
        
        <hr style="border: 0; border-top: 1px solid #eee; margin: 20px 0;">
        
        <p><strong>Want to test it again?</strong><br>
        Closing the popup sets a 24-hour cookie. Click below to clear that cookie and reload the page.</p>
        
        <button class="btn-reset" onclick="resetCookieAndReload()">Reset Cookie & Reload Page</button>
    </div>

    <!-- 
      3. THE SCRIPT 
      In a real scenario, this exact code block goes into Google Tag Manager 
      (Custom HTML Tag) or directly before the closing </body> tag.
    -->
    <script>
    (function(){
      // URL Configuration
      // ADD LINK HERE WITH
      var e = '';
      var t = "widgetShown"; // Cookie Name
      var n = 86400; // Cookie Duration (Seconds)
    
      // 1. Check if Cookie exists or if Overlay already exists
      if (document.cookie.indexOf(t + "=true") !== -1 || document.getElementById("bliz__overlay_container")) {
        console.log("Bliz Demo: Cookie found or Widget active. Skipping injection.");
        return;
      }
    
      // 2. Create Overlay Div
      var o = document.createElement("div");
      o.id = "bliz__overlay_container";
      o.className = "bliz__overlay";
      // Added background blur for modern look
      o.style.cssText = "position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,0.6);backdrop-filter:blur(2px);z-index:9999;display:flex;justify-content:center;align-items:center;";
      
      // 3. Inject Iframe & Close Button
      o.innerHTML =
        '<iframe src="' + e + '" class="bliz__iframe" style="position:absolute;top:0;left:0;width:100vw;height:100vh;border:none;" title="Promotion Widget"></iframe>' +
        '<button id="bliz__close_btn" class="bliz__close_btn" style="position:absolute;top:20px;right:20px;background:#fff;border-radius:50%;width:40px;height:40px;border:none;cursor:pointer;font-size:24px;font-weight:bold;z-index:10000;display:flex;align-items:center;justify-content:center;box-shadow:0 2px 10px rgba(0,0,0,0.3);color:#333;">Ã—</button>';
    
      document.body.appendChild(o);
    
      // 4. Close Functionality
      function i() {
        if (o && o.parentNode) {
          o.parentNode.removeChild(o);
          // Set Cookie when closed
          document.cookie = t + "=true; path=/; max-age=" + n;
          console.log("Bliz Demo: Widget closed. Cookie set.");
        }
      }
    
      var btn = document.getElementById("bliz__close_btn");
      if (btn) {
        btn.addEventListener("click", function () { i(); });
      }
    
      // Close on Background Click
      o.addEventListener("click", function (a) {
        if (a.target === o) i();
      });
    
      // Close on Escape Key
      document.addEventListener("keydown", function (a) {
        if (a.keyCode === 27) i();
      });
    
      // Close via PostMessage (from inside iframe)
      window.addEventListener("message", function (a) {
        try {
          // Flexible origin check for demo purposes
          if (a.data === "closeWidget") {
            i();
          }
        } catch (err) {
          console.error("Widget postMessage error:", err);
        }
      });
    })();
    </script>

    <!-- Helper for the Demo Page Control Panel -->
    <script>
        function resetCookieAndReload() {
            // Expire the cookie immediately
            document.cookie = "widgetShown=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;";
            location.reload();
        }
    </script>
</body>
</html>