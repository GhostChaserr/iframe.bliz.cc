<script>
  (function(){
    var e = {{blizWidgetUrl}}; // Replaced by GTM variable
    var t = "widgetShown";
    var n = 86400;
  
    if (document.cookie.indexOf(t + "=true") !== -1 || document.getElementById("bliz__overlay_container")) return;
  
    var o = document.createElement("div");
    o.id = "bliz__overlay_container";
    o.className = "bliz__overlay";
    o.style.cssText = "position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,0.5);z-index:9999;display:flex;justify-content:center;align-items:center;";
    o.innerHTML =
      '<iframe src="' + e + '" class="bliz__iframe" style="position:absolute;top:0;left:0;width:100vw;height:100vh;border:none;" title="Promotion Widget"></iframe>' +
      '<button id="bliz__close_btn" class="bliz__close_btn" style="position:absolute;top:20px;right:20px;background:#fff;border-radius:50%;width:40px;height:40px;border:2px solid #000;cursor:pointer;font-size:24px;font-weight:bold;z-index:10000;display:flex;align-items:center;justify-content:center;box-shadow:0 2px 5px rgba(0,0,0,0.2);color:#000;">Ã—</button>';
  
    document.body.appendChild(o);
  
    function i() {
      if (o && o.parentNode) {
        o.parentNode.removeChild(o);
        document.cookie = t + "=true; path=/; max-age=" + n;
      }
    }
  
    var btn = document.getElementById("bliz__close_btn");
    if (btn) {
      btn.addEventListener("click", function () {
        i();
      });
    }
  
    o.addEventListener("click", function (a) {
      if (a.target === o) {
        i();
      }
    });
  
    document.addEventListener("keydown", function (a) {
      if (a.keyCode === 27) {
        i();
      }
    });
  
    window.addEventListener("message", function (a) {
      try {
        var domain = document.createElement("a");
        domain.href = e;
        var host = domain.hostname;
        if (a.origin.indexOf(host) !== -1 && a.data === "closeWidget") {
          i();
        }
      } catch (err) {
        console.error("Widget postMessage error:", err);
      }
    });
  })();
  </script>
  